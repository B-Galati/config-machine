- name: Set ZSH shell for {{ ansible_user }}
  become: true
  user: name={{ ansible_user }} shell=/bin/zsh state=present

- name: install sudo, aptitude and locales
  become: true
  apt:
    name: '{{ packages }}'
    update_cache: yes
    cache_valid_time: 3600
  vars:
    packages:
      - sudo
      - aptitude
      - locales

- name: Install locales
  become: true
  locale_gen: name={{ item }} state=present
  with_items:
  - en_US.UTF-8
  - fr_FR.UTF-8

- name: Set LANG to en_US.UTF-8
  become: true
  shell: update-locale LANG=en_US.UTF-8

- name: Add user {{ ansible_user }}
  become: true
  user: name={{ ansible_user }} groups=adm,sudo append=yes createhome=no

- name: Add ENV vars in /etc/profile.d/custom.sh
  become: true
  copy:
    dest: /etc/profile.d/custom.sh
    mode: 0644
    content: |
      PATH="$PATH:/snap/bin"

      # https://remysharp.com/2018/08/23/cli-improved
      # add support for ctrl+o to open selected file in VS Code
      export FZF_DEFAULT_OPTS="--bind='ctrl-o:execute(code {})+abort'"
